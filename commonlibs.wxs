<?xml version="1.0" encoding="utf-8"?>

<?define QtPATH = "C:\Qt\5.5\msvc2013" ?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <ComponentGroup Id="CommonLibs">
      <ComponentRef Id="libeay32.dll"/>
      <ComponentRef Id="ssleay32.dll"/>
      <ComponentRef Id="zlib1.dll"/>
      <ComponentRef Id="msvcr120.dll_x86"/>
      <?if $(var.Platform) = "x64" ?>
        <ComponentRef Id="libeay32_64.dll"/>
        <ComponentRef Id="ssleay32_64.dll"/>
        <!--ComponentRef Id="zlib1_64.dll"/-->
        <ComponentRef Id="msvcr120.dll_x64"/>
      <?endif?>
    </ComponentGroup>
    <ComponentGroup Id="QtLibs">
      <ComponentRef Id="Qt5Core" />
      <ComponentRef Id="qwindows.dll" />
      <ComponentRef Id="qjpeg.dll" />
      <ComponentRef Id="windowsprintersupport.dll" />
    </ComponentGroup>

    <DirectoryRef Id="APPLICATIONFOLDER">
      <Component Id="Qt5Core" Guid="10c67888-e9f6-4546-af61-d760064c3caa">
        <File Source="$(var.QtPATH)\bin\Qt5Core.dll" />
        <File Source="$(var.QtPATH)\bin\Qt5Gui.dll" />
        <File Source="$(var.QtPATH)\bin\Qt5Network.dll" />
        <File Source="$(var.QtPATH)\bin\Qt5PrintSupport.dll" />
        <File Source="$(var.QtPATH)\bin\Qt5Widgets.dll" />
        <File Source="$(var.QtPATH)\bin\Qt5WinExtras.dll" />
        <File Source="$(var.QtPATH)\bin\libEGL.dll" />
        <File Source="$(var.QtPATH)\bin\libGLESv2.dll" />
        <File Source="$(var.QtPATH)\bin\icudt54.dll" />
        <File Source="$(var.QtPATH)\bin\icuin54.dll" />
        <File Source="$(var.QtPATH)\bin\icuuc54.dll" />
        <File Source="$(var.QtPATH)\bin\D3DCompiler_47.dll" />
        <File Source="$(var.QtPATH)\bin\opengl32sw.dll" />
      </Component>

      <Directory Id="platforms" Name="platforms">
        <Component Id="qwindows.dll" Guid="*">
          <File Source="$(var.QtPATH)\plugins\platforms\qwindows.dll" />
        </Component>
      </Directory>
      <Directory Id="imageformats" Name="imageformats">
        <Component Id="qjpeg.dll" Guid="*">
          <File Source="$(var.QtPATH)\plugins\imageformats\qjpeg.dll" />
        </Component>
      </Directory>
      <Directory Id="printsupport" Name="printsupport">
        <Component Id="windowsprintersupport.dll" Guid="*">
          <File Source="$(var.QtPATH)\plugins\printsupport\windowsprintersupport.dll" />
        </Component>
      </Directory>

      <Component Id="libeay32.dll" Guid="*">
        <File Id="libeay32.dll" Source="C:\OpenSSL-Win32\bin\libeay32.dll" Checksum="yes" Vital="yes"/>
      </Component>
      <Component Id="ssleay32.dll" Guid="*">
        <File Id="ssleay32.dll" Source="C:\OpenSSL-Win32\bin\ssleay32.dll" Checksum="yes" Vital="yes"/>
      </Component>
      <Component Id="zlib1.dll" Guid="*">
        <File Source="$(env.CLIENT_PATH)\zlib1.dll" Checksum="yes" Vital="yes"/>
      </Component>
      <Component Id="msvcr120.dll_x86" Guid="0ADF75A7-1492-417A-A6CE-C202D46735EB" Win64="no">
        <File Id="msvcr120.dll_x86" Source="$(env.VCINSTALLDIR)\redist\x86\Microsoft.VC120.CRT\msvcr120.dll" Checksum="yes" Vital="yes"/>
        <File Id="msvcp120.dll_x86" Source="$(env.VCINSTALLDIR)\redist\x86\Microsoft.VC120.CRT\msvcp120.dll" Checksum="yes" Vital="yes"/>
      </Component>
      <Component Id="msvcr100.dll_x86" Guid="92D9435D-5C8A-4A51-92E6-A94819BBDFC7" Win64="no">
        <File Id="msvcr100.dll_x86" Source="x86\msvcr100.dll" Checksum="yes" Vital="yes"/>
        <File Id="msvcp100.dll_x86" Source="x86\msvcp100.dll" Checksum="yes" Vital="yes"/>
      </Component>
    </DirectoryRef>

    <?if $(var.Platform)=x64 ?>
    <DirectoryRef Id="APPLICATION64FOLDER">
      <Component Id="libeay32_64.dll" Guid="*" Win64="yes">
        <File Id="libeay32_64.dll" Source="C:\OpenSSL-Win64\bin\libeay32.dll" Checksum="yes" Vital="yes"/>
      </Component>
      <Component Id="ssleay32_64.dll" Guid="*" Win64="yes">
        <File Id="ssleay32_64.dll" Source="C:\OpenSSL-Win64\bin\ssleay32.dll" Checksum="yes" Vital="yes"/>
      </Component>
      <!--Component Id="zlib1_64.dll" Guid="*" Win64="yes">
        <File Id="zlib1_64.dll" Source="C:\install\zlib\x64\bin\zlib1.dll" Checksum="yes" Vital="yes"/>
      </Component-->
      <Component Id="msvcr120.dll_x64" Guid="74CCB83C-31F8-4790-AEB5-71364FDA52AA" Win64="yes">
        <File Id="msvcr120.dll_x64" Source="$(env.VCINSTALLDIR)\redist\x64\Microsoft.VC120.CRT\msvcr120.dll" Checksum="yes" Vital="yes"/>
        <File Id="msvcp120.dll_x64" Source="$(env.VCINSTALLDIR)\redist\x64\Microsoft.VC120.CRT\msvcp120.dll" Checksum="yes" Vital="yes"/>
      </Component>
      <Component Id="msvcr100.dll_x64" Guid="840D6314-B49C-4EE5-A764-A8BEB03E0BD8" Win64="yes">
        <File Id="msvcr100.dll_x64" Source="x64\msvcr100.dll" Checksum="yes" Vital="yes"/>
        <File Id="msvcp100.dll_x64" Source="x64\msvcp100.dll" Checksum="yes" Vital="yes"/>
      </Component>
    </DirectoryRef>
    <?endif?>
  </Fragment>
</Wix>
